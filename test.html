<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>查找index.m3u8文件</title>
</head>
<body>
  <h2>选择一个文件夹，查找所有子文件夹下的index.m3u8</h2>
  <input type="file" id="dirInput" webkitdirectory directory multiple />
  <pre id="result"></pre>

  <script>
    document.getElementById('dirInput').addEventListener('change', function(event) {
      const files = Array.from(event.target.files);
      // 用于存储找到的index.m3u8路径
      const foundPaths = [];

      // 以文件夹为单位分组
      const folderMap = {};
      files.forEach(file => {
        // file.webkitRelativePath 例： 'A/B/index.m3u8'
        const parts = file.webkitRelativePath.split('/');
        if (parts.length >= 2) {
          const folder = parts.slice(0, -1).join('/');
          if (!folderMap[folder]) folderMap[folder] = [];
          folderMap[folder].push(file);
        }
      });

      // 遍历每个子文件夹，查找index.m3u8
      Object.entries(folderMap).forEach(([folder, fileList]) => {
        const hasIndex = fileList.some(f => f.name === 'index.m3u8');
        if (hasIndex) {
          // 找到index.m3u8，打印其相对路径
          const indexFile = fileList.find(f => f.name === 'index.m3u8');
          foundPaths.push(indexFile.webkitRelativePath);
        }
      });

      // 显示结果
      document.getElementById('result').textContent = foundPaths.length
        ? '找到的index.m3u8文件路径：\n' + foundPaths.join('\n')
        : '未找到任何index.m3u8文件';
    });
  </script>
</body>
</html>